Chunk = require 'ObojoboDraft/models/chunk'

module.exports = (componentClass, position, referenceChunk, selection, callback) ->
	newChunk = Chunk.create componentClass
	extraChunk = null

	switch position
		when 'before'
			referenceChunk.addBefore newChunk
			if newChunk.isFirst() then newChunk.addBefore Chunk.create()

		when 'after'
			referenceChunk.addAfter newChunk
			if newChunk.isLast() then newChunk.addAfter Chunk.create()

	newChunk.selectStart selection

	callback()