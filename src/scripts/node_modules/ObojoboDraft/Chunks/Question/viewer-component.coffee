require './viewer-component.scss'

Common = window.ObojoboDraft.Common

OboComponent = Common.components.OboComponent

Question = React.createClass
	getInitialState: ->
		score: null

	setScore: (score) ->
		@setState { score:score }

	componentWillReceiveProps: (nextProps) ->
		if nextProps.model isnt @props.model
			@setScore null

	render: ->
		`<OboComponent
			model={this.props.model}
			className={'obojobo-draft--chunks--question' + (this.state.score === null ? '' : (this.state.score === 100 ? ' is-correct' : ' is-incorrect'))}
		>
			{
				this.props.model.children.models.map((function(child, index) {
					var Component = child.getComponentClass()
					return <Component key={child.get('id')} model={child} setScore={this.setScore} score={this.state.score} />
				}).bind(this))
			}
		</OboComponent>`

module.exports = Question