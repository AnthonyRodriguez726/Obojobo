addEl = (url, el, onLoad = null, onError = null) ->
	if loaded[url]
		if onLoad? then onLoad url
		return true # return true, meaning the file was loaded

	if onError? then el.onerror = onError
	if onLoad? then el.onload = ->
		loaded[url] = url
		onLoad url

	document.head.appendChild el

	false # return false, meaning the file wasn't already loaded

loaded = {}

module.exports =
	add: (urlOrUrls, onLoad = null, onError = null) ->
		console.log 'add', arguments

		if typeof urlOrUrls is 'string'
			urls = [urlOrUrls]
		else
			urls = urlOrUrls

		for url in urls
			type = url.substr url.lastIndexOf('.') + 1
			console.log type
			switch type
				when 'js'
					script = document.createElement 'script'
					script.setAttribute 'src', url
					addEl url, script, onLoad, onError

				when 'css'
					link = document.createElement 'link'
					link.setAttribute 'rel', 'stylesheet'
					link.setAttribute 'href', url
					addEl url, link, onLoad, onError