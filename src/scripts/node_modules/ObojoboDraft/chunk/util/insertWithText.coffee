Chunk = require 'ObojoboDraft/models/chunk'

module.exports = (componentClass, position, referenceChunk, selection, callback) ->
	newChunk = Chunk.create componentClass
	extraChunk = null

	switch position
		when 'before'
			referenceChunk.addChunkBefore newChunk
			if newChunk.isFirst() then newChunk.addChunkBefore Chunk.create()

		when 'after'
			referenceChunk.addChunkAfter newChunk
			if newChunk.isLast() then newChunk.addChunkAfter Chunk.create()

	newChunk.selectStart()

	callback()