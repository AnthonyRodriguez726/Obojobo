Chunk = require 'ObojoboDraft/models/chunk'

module.exports = (componentClass, position, referenceChunk, selection, callback) ->
	newChunk = Chunk.create componentClass
	extraChunk = null

	switch position
		when 'before'
			referenceChunk.addChildBefore newChunk
			if newChunk.isFirst() then newChunk.addChildBefore Chunk.create()

		when 'after'
			referenceChunk.addChildAfter newChunk
			if newChunk.isLast() then newChunk.addChildAfter Chunk.create()

	newChunk.selectStart()

	callback()