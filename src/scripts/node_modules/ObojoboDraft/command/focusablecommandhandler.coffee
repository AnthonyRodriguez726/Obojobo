BaseCommandHandler = require './basecommandhandler'
Text = require 'ObojoboDraft/components/text'
linkify = require 'ObojoboDraft/util/linkify'
TextGroupSelection = require 'ObojoboDraft/text/textgroupselection'
Chunk = require 'ObojoboDraft/models/chunk'

module.exports = class FocusableCommandHandler extends BaseCommandHandler
	selectAll: (selection, chunk) ->
		selection.setFutureCaret chunk, { groupIndex:'anchor:main', offset:0 }

	selectStart: (selection, chunk) ->
		selection.setFutureCaret chunk, { groupIndex:'anchor:main', offset:0 }

	selectEnd: (selection, chunk) ->
		selection.setFutureCaret chunk, { groupIndex:'anchor:main', offset:0 }

	restoreSelection: (selection, chunk, type, savedSelData) ->
		node = Text.getTextNode chunk, savedSelData.groupIndex
		return null if not node?

		domPos = Text.getDomPosition savedSelData.offset, node

		if type is 'start'
			selection.chunk.setTextStart domPos.textNode, domPos.offset
		else if type is 'end'
			selection.chunk.setTextEnd domPos.textNode, domPos.offset

	deleteText: (selection, chunk, deleteForwards) ->
		# newChunk = Chunk.create()
		# chunk.replaceWith newChunk

		# newChunk.selectEnd selection
		chunk.revert selection