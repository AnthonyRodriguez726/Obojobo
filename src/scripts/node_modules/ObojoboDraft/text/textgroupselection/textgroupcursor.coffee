Text = require 'ObojoboDraft/components/text'

getText = (chunk, index) ->
	data = chunk.componentContent

	if isNaN(parseInt(index, 10)) or index < 0 or index >= data.textGroup.length then return null

	data.textGroup.get(index).text

class TextGroupCursor
	constructor: (groupIndex, offset, text) ->
		@groupIndex = groupIndex
		@offset = offset
		@text = text

	toObject: ->
		groupIndex: @groupIndex
		offset: @offset


TextGroupCursor.createFromCursor = (cursor) ->
	if not cursor.isText then return null

	info = Text.getOboTextInfo cursor.textNode, cursor.offset

	new TextGroupCursor info.groupIndex, info.offset, getText(cursor.chunk, info.groupIndex)


module.exports = TextGroupCursor