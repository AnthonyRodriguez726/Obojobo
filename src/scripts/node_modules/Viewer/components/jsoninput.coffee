JSONInput = React.createClass
	getInitialState: ->
		value: @props.value
		open: false

	componentWillReceiveProps: (nextProps) ->
		@setState {
			value: nextProps.value
		}

	onClick: (event) ->
		@props.onChange @state.value

	onChange: (event) ->
		@setState { value:event.target.value }

	onToggle: (event) ->
		newVal = !@state.open
		@setState { open:newVal }
		@props.onToggle newVal

	render: ->
		if(@state.open)
			return `<div style={{position:'fixed',right:0,top:0,bottom:0,width:'300px',background:'gray',zIndex:9999}}>
				<button style={{position:'absolute',top:'0',left:0,display:'block',width:'300px'}} onClick={this.onToggle}>Close</button>
				<textarea style={{position:'absolute',left:0,top:'20px',right:0,bottom:'40px',width:'300px', fontFamily:'monospace', fontSize:'10pt',padding:0,margin:0,boxSizing:'border-box'}} value={this.state.value} onChange={this.onChange} />
				<button style={{position:'absolute',bottom:'10px',left:0,display:'block',width:'300px'}} onClick={this.onClick}>Update</button>
			</div>`

		return `<div style={{position:'fixed',right:0,top:0,zIndex:9999}}>
			<button onClick={this.onToggle}>Open</button>
		</div>`


module.exports = JSONInput