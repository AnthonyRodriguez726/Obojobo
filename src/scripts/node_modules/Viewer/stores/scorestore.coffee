Store = window.ObojoboDraft.Common.flux.Store
Dispatcher = window.ObojoboDraft.Common.flux.Dispatcher

state = {
	scores: {}
}

ScoreStore = Object.assign(new Store(),
	getState: -> state

	setState: (newState) -> state = newState

	getScore: (model) ->
		score = state.scores[model.get('id')]
		if typeof score is 'undefined' then return null

		score
)

ScoreStore.dispatchToken = Dispatcher.register (payload) ->
	switch payload.type
		when 'score:set'
			console.log 'setScore', payload
			state.scores[payload.value.id] = payload.value.score

		when 'score:clear'
			delete state.scores[payload.value.id]

	ScoreStore.emitChange()


module.exports = ScoreStore