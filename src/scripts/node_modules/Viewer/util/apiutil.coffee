APIUtil =
	post: (endpoint, body) ->
		fetch endpoint, {
			method: 'POST',
			body: JSON.stringify(body),
			headers:
				'Accept': 'application/json',
				'Content-Type': 'application/json'
		}

	postEvent: (lo, eventAction, eventPayload) ->
		APIUtil.post '/api/events', {
			event:
				action: eventAction,
				draft_id: lo.get('_id')
				draft_rev: lo.get('_rev')
				actorTime: new Date().toISOString()
				payload: eventPayload
		}

	saveState: (lo, state) ->
		APIUtil.postEvent lo, 'saveState', state

	fetchDraft: (id) ->
		promise = new Promise (resolve, reject) ->
			fetch "/api/drafts/#{id}"
				.then (res) => res.json()
				.then (json) => resolve(json)
				.catch (error) => reject(error)

		promise


module.exports = APIUtil