Editor = window.Editor
ObojoboDraft = window.ObojoboDraft

TextGroupCommandHandler = Editor.chunk.textChunk.TextGroupCommandHandler
TextGroupSelection = ObojoboDraft.textGroup.TextGroupSelection
Chunk = ObojoboDraft.models.Chunk


module.exports = class CommandHandler extends TextGroupCommandHandler
	splitText: (selection, chunk, shiftKey) ->
		chunk.markDirty()

		tgs = new TextGroupSelection chunk, selection.virtual

		if tgs.start.isGroupStart
			# super selection, chunk, shiftKey
			newChunk = Chunk.create()
			chunk.addChildBefore newChunk
			return


		newText = tgs.start.text.split tgs.start.offset

		newNode = Chunk.create() #@TODO - assumes it has a textGroup
		newNode.componentContent.textGroup.first.text = newText
		chunk.addChildAfter newNode

		# selection.setFutureCaret newNode, { offset: 0, groupIndex: 0 }
		# TextGroupSelection.setCaretToGroupStart newNode, selection.virtual
		newNode.selectStart()