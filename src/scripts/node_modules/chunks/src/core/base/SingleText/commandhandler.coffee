TextGroupCommandHandler = Editor.command.TextGroupCommandHandler
TextGroupSelection = ObojoboDraft.text.TextGroupSelection

module.exports = class CommandHandler extends TextGroupCommandHandler
	splitText: (selection, chunk, shiftKey) ->
		chunk.markDirty()

		tgs = new TextGroupSelection chunk, selection.virtual
		textGroup = chunk.componentContent.textGroup

		if tgs.start.text.length is 0
			# If splitting an empty one item paragraph create a new paragraph below
			if textGroup.length is 1
				sibChunk = chunk.clone()
				sibChunk.componentContent.textGroup.init(1)

				chunk.addChunkAfter sibChunk

				TextGroupSelection.setCaretToGroupStart sibChunk, selection.virtual

			# If splitting an empty textGroup item that's not a one item paragraph
			# then split into three paragraphs:
			else
				splitChildren = chunk.split()

			return

		super selection, chunk, shiftKey
