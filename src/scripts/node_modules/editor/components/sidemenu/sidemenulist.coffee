require './sidemenulist.scss'

ComponentClassMap = require('ObojoboDraft').util.ComponentClassMap

WIDTH = 30
HEIGHT = 30
MENU_OPEN_DURATION_MS = 100

SideMenuList = React.createClass
	getInitialState: ->
		open: false

	open: ->
		clearTimeout @timeoutId
		@setState { open:true }

	close: ->
		@timeoutId = setTimeout (->
			@setState { open:false }
		).bind(@), MENU_OPEN_DURATION_MS

	onMouseDown: (componentClass) ->
		@close()
		@props.onMouseDown componentClass

	render: ->
		onMouseDown = @onMouseDown
		children = []
		self = @
		@props.inserts.forEach (insert, index) ->
			componentClass = ComponentClassMap.getClassForType insert.chunk
			mouseDown = (event) ->
				event.preventDefault()
				self.onMouseDown.bind(self, componentClass)()
			children.push `<button key={index} onMouseDown={mouseDown}>{insert.label}</button>`

		`<div
			className={'editor--components--side-menu--side-menu-list' + (this.state.open ? ' open' : '')}
			onMouseOver={this.open}
			onMouseOut={this.close}
			style={{top: this.props.yPos + 'px'}}
		>
			<div className="insert-button">+</div>
			<div className="insert-list" style={{display: (this.state.open ? 'inline-block' : 'none')}}>{children}</div>
		</div>`


module.exports = SideMenuList